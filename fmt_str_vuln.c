#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#include <sys/mman.h>

void vuln(char *input) {
    printf(input);
}

int main(int argc, char **argv) {
    char secret_str[] = "Y0u_f0und_th3_s3cr3t_key";
    printf("Can you guess the secret key?\n");
    
    // heap-allocated
    char *secret = malloc(strlen(secret_str)+1);
    sprintf(secret, secret_str);
    
    // stack-allocated
    char input[50];

    // bounded fgets to prevent buffer overflow
    fgets(input, 50, stdin);

    // ğŸ‘¿ğŸ‘¿ğŸ‘¿
    vuln(input);
}
